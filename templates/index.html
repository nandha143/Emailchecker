<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Email Generator & Formatter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .mode-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .mode-btn.active {
            background: white;
            color: #4facfe;
            border-color: white;
        }

        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .input-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-field, .email-textarea {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-field:focus, .email-textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .email-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .casual-input {
            min-height: 100px;
        }

        .action-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .action-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            align-items: center;
            gap: 10px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .results-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            display: none;
            max-height: 80vh;
            overflow-y: auto;
        }

        .results-section.show {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #4facfe;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .result-header {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .generated-email {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.6;
            white-space: pre-wrap;
            border: 1px solid #e0e0e0;
            max-height: 300px;
            overflow-y: auto;
        }

        .copy-btn {
            margin-top: 10px;
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: #218838;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .score-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .score-number {
            font-size: 2.5em;
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }

        .score-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .tone-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tone-professional { background: #28a745; color: white; }
        .tone-semi-professional { background: #ffc107; color: #333; }
        .tone-casual { background: #17a2b8; color: white; }

        .list-items {
            list-style: none;
            padding: 0;
        }

        .list-items li {
            background: rgba(79, 172, 254, 0.1);
            margin: 8px 0;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #4facfe;
        }

        .improvements-list li {
            background: rgba(255, 193, 7, 0.1);
            border-left-color: #ffc107;
        }

        .issues-list li {
            background: rgba(220, 53, 69, 0.1);
            border-left-color: #dc3545;
        }

        .component-check {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
        }

        .check-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .check-yes {
            background: #28a745;
            color: white;
        }

        .check-no {
            background: #dc3545;
            color: white;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #dc3545;
            margin-bottom: 15px;
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr 1fr;
            }

            .mode-toggle {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Smart Email Generator & Formatter</h1>
            <p>Convert casual messages to professional emails with AI-powered analysis</p>
            
            <div class="mode-toggle">
                <button class="mode-btn active" onclick="switchMode('generate')">üìù Generate Email</button>
                <button class="mode-btn" onclick="switchMode('analyze')">üîç Analyze Email</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <!-- Generate Email Mode -->
                <div id="generateMode" class="mode-section active">
                    <div class="form-group">
                        <label for="casualMessage">üó®Ô∏è Your Message (Casual):</label>
                        <textarea id="casualMessage" class="email-textarea casual-input" 
                                  placeholder="Type your casual message here...

Example: 'i am having a fever i am planning to leave'"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="senderName">üë§ Your Name (Optional):</label>
                        <input type="text" id="senderName" class="input-field" placeholder="John Doe">
                    </div>
                    
                    <div class="form-group">
                        <label for="recipientName">üë• Recipient Name (Optional):</label>
                        <input type="text" id="recipientName" class="input-field" placeholder="Manager/HR">
                    </div>
                    
                    <button id="generateBtn" class="action-btn">
                        <span class="btn-text">Generate Professional Email</span>
                        <div class="loading">
                            <div class="spinner"></div>
                            <span>Generating...</span>
                        </div>
                    </button>
                </div>

                <!-- Analyze Email Mode -->
                <div id="analyzeMode" class="mode-section">
                    <div class="form-group">
                        <label for="existingEmail">üìß Email Content to Analyze:</label>
                        <textarea id="existingEmail" class="email-textarea" 
                                  placeholder="Paste your existing email here for analysis...

Example:
Subject: Sick Leave Request

Dear Manager,

I am writing to inform you that I am feeling unwell today and will not be able to come to work.

Best regards,
John Doe"></textarea>
                    </div>
                    
                    <button id="analyzeBtn" class="action-btn">
                        <span class="btn-text">Analyze Email Quality</span>
                        <div class="loading">
                            <div class="spinner"></div>
                            <span>Analyzing...</span>
                        </div>
                    </button>
                </div>
            </div>
            
            <div class="results-section" id="resultsSection">
                <div id="resultsContent"></div>
            </div>
        </div>
    </div>

    <script>
        class SmartEmailProcessor {
            constructor() {
                this.currentMode = 'generate';
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                // Generate mode elements
                this.casualMessageTextarea = document.getElementById('casualMessage');
                this.senderNameInput = document.getElementById('senderName');
                this.recipientNameInput = document.getElementById('recipientName');
                this.generateBtn = document.getElementById('generateBtn');

                // Analyze mode elements
                this.existingEmailTextarea = document.getElementById('existingEmail');
                this.analyzeBtn = document.getElementById('analyzeBtn');

                // Common elements
                this.resultsSection = document.getElementById('resultsSection');
                this.resultsContent = document.getElementById('resultsContent');
            }

            bindEvents() {
                this.generateBtn.addEventListener('click', () => this.generateEmail());
                this.analyzeBtn.addEventListener('click', () => this.analyzeEmail());
            }

            async generateEmail() {
                const casualMessage = this.casualMessageTextarea.value.trim();
                const senderName = this.senderNameInput.value.trim();
                const recipientName = this.recipientNameInput.value.trim();

                if (!casualMessage) {
                    this.showError('Please enter your casual message');
                    return;
                }

                this.setLoading(this.generateBtn, true);

                try {
                    const response = await this.callAPI('/generate_email', {
                        message: casualMessage,
                        sender_name: senderName,
                        recipient_name: recipientName
                    });

                    this.displayGenerationResults(response);
                } catch (error) {
                    this.showError(`Error generating email: ${error.message}`);
                } finally {
                    this.setLoading(this.generateBtn, false);
                }
            }

            async analyzeEmail() {
                const emailContent = this.existingEmailTextarea.value.trim();

                if (!emailContent) {
                    this.showError('Please enter email content to analyze');
                    return;
                }

                this.setLoading(this.analyzeBtn, true);

                try {
                    const response = await this.callAPI('/analyze_existing', {
                        content: emailContent
                    });

                    this.displayAnalysisResults(response);
                } catch (error) {
                    this.showError(`Error analyzing email: ${error.message}`);
                } finally {
                    this.setLoading(this.analyzeBtn, false);
                }
            }

            async callAPI(endpoint, data) {
                // In a real implementation, this would call your Flask backend
                // For now, we'll simulate the API response
                return new Promise((resolve) => {
                    setTimeout(() => {
                        if (endpoint === '/generate_email') {
                            resolve(this.simulateGenerationResponse(data));
                        } else {
                            resolve(this.simulateAnalysisResponse(data));
                        }
                    }, 2000);
                });
            }

            simulateGenerationResponse(data) {
                const { message, sender_name, recipient_name } = data;
                
                // Simulate formal email generation
                let formalEmail = '';
                
                if (message.toLowerCase().includes('fever') && message.toLowerCase().includes('leave')) {
                    formalEmail = `Subject: Sick Leave Request - ${new Date().toLocaleDateString()}

Dear ${recipient_name || 'Manager'},

I hope this email finds you well. I am writing to inform you that I am currently experiencing flu-like symptoms, including a fever, which makes it necessary for me to take sick leave today.

I understand the importance of my responsibilities and will ensure that any urgent matters are addressed remotely if possible. I will monitor my health condition and keep you updated on my expected return date.

Please let me know if there are any immediate priorities that need attention during my absence.

Thank you for your understanding.

Best regards,
${sender_name || '[Your Name]'}
${sender_name ? '[Your Position]' : ''}
${sender_name ? '[Your Contact Information]' : ''}`;
                } else {
                    formalEmail = `Subject: [Auto-generated based on your message]

Dear ${recipient_name || '[Recipient Name]'},

${this.convertToFormalLanguage(message)}

Best regards,
${sender_name || '[Your Name]'}`;
                }

                return {
                    original_message: message,
                    formal_email: formalEmail,
                    analysis: {
                        overall_rating: "9",
                        tone_assessment: "Professional",
                        strengths: [
                            "Clear and professional subject line",
                            "Appropriate greeting and closing",
                            "Well-structured content",
                            "Professional tone throughout"
                        ],
                        improvements: [
                            "Consider adding specific return date if known",
                            "Include contact information for urgent matters"
                        ],
                        grammar_issues: [],
                        format_score: "9",
                        clarity_score: "9"
                    },
                    components: {
                        has_subject: true,
                        has_greeting: true,
                        has_closing: true,
                        has_signature: true,
                        word_count: formalEmail.split(' ').length,
                        character_count: formalEmail.length,
                        paragraph_count: formalEmail.split('\n\n').length
                    }
                };
            }

            simulateAnalysisResponse(data) {
                const emailContent = data.content;
                const hasSubject = emailContent.toLowerCase().includes('subject:');
                const hasGreeting = /\b(dear|hello|hi|greetings)\b/i.test(emailContent);
                const hasClosing = /\b(sincerely|best regards|regards|best)\b/i.test(emailContent);
                
                let rating = 7;
                if (!hasSubject) rating -= 2;
                if (!hasGreeting) rating -= 1;
                if (!hasClosing) rating -= 1;

                return {
                    email_content: emailContent,
                    analysis: {
                        overall_rating: rating.toString(),
                        tone_assessment: hasGreeting && hasClosing ? "Professional" : "Casual",
                        strengths: [
                            hasSubject ? "Includes subject line" : "Clear message content",
                            hasGreeting ? "Professional greeting" : "Direct communication",
                            hasClosing ? "Appropriate closing" : "Concise format"
                        ].filter(Boolean),
                        improvements: [
                            !hasSubject ? "Add a clear subject line" : null,
                            !hasGreeting ? "Include a professional greeting" : null,
                            !hasClosing ? "Add a professional closing" : null,
                            "Consider proofreading for any grammar issues"
                        ].filter(Boolean),
                        grammar_issues: [],
                        format_score: rating.toString(),
                        clarity_score: (rating + 1).toString()
                    },
                    components: {
                        has_subject: hasSubject,
                        has_greeting: hasGreeting,
                        has_closing: hasClosing,
                        has_signature: /\n\s*[A-Z][a-z]+ [A-Z][a-z]+\s*$/m.test(emailContent),
                        word_count: emailContent.split(' ').length,
                        character_count: emailContent.length,
                        paragraph_count: emailContent.split('\n\n').length
                    }
                };
            }

            convertToFormalLanguage(casualMessage) {
                // Simple conversion logic
                let formal = casualMessage.charAt(0).toUpperCase() + casualMessage.slice(1);
                formal = formal.replace(/\bi\b/g, 'I');
                formal = formal.replace(/u\b/g, 'you');
                formal = formal.replace(/ur\b/g, 'your');
                return formal + (formal.endsWith('.') ? '' : '.');
            }

            displayGenerationResults(data) {
                let html = '';

                // Generated Email
                html += `
                    <div class="result-card">
                        <div class="result-header">‚ú® Generated Professional Email</div>
                        <div class="generated-email">${data.formal_email}</div>
                        <button class="copy-btn" onclick="navigator.clipboard.writeText(\`${data.formal_email.replace(/`/g, '\\`')}\`)">
                            üìã Copy Email
                        </button>
                    </div>
                `;

                // Analysis scores
                const analysis = data.analysis;
                html += `
                    <div class="result-card">
                        <div class="result-header">üìä Quality Analysis</div>
                        <div class="analysis-grid">
                            <div class="score-card">
                                <span class="score-number">${analysis.format_score}</span>
                                <div class="score-label">Format Score</div>
                            </div>
                            <div class="score-card">
                                <span class="score-number">${analysis.clarity_score}</span>
                                <div class="score-label">Clarity Score</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <strong>Tone Assessment:</strong>
                            <span class="tone-badge tone-${analysis.tone_assessment.toLowerCase().replace('-', '')}">${analysis.tone_assessment}</span>
                        </div>
                    </div>
                `;

                // Strengths
                if (analysis.strengths && analysis.strengths.length > 0) {
                    html += `
                        <div class="result-card">
                            <div class="result-header">‚úÖ Strengths</div>
                            <ul class="list-items">
                                ${analysis.strengths.map(strength => `<li>${strength}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Improvements
                if (analysis.improvements && analysis.improvements.length > 0) {
                    html += `
                        <div class="result-card">
                            <div class="result-header">üí° Suggestions for Improvement</div>
                            <ul class="list-items improvements-list">
                                ${analysis.improvements.map(improvement => `<li>${improvement}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Email Components Check
                html += this.generateComponentsCheck(data.components);

                // Original Message
                html += `
                    <div class="result-card">
                        <div class="result-header">üìù Original Message</div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-style: italic;">
                            "${data.original_message}"
                        </div>
                    </div>
                `;

                this.resultsContent.innerHTML = html;
                this.resultsSection.classList.add('show');
            }

            displayAnalysisResults(data) {
                let html = '';

                // Analysis scores
                const analysis = data.analysis;
                html += `
                    <div class="result-card">
                        <div class="result-header">üìä Email Quality Analysis</div>
                        <div class="analysis-grid">
                            <div class="score-card">
                                <span class="score-number">${analysis.overall_rating}</span>
                                <div class="score-label">Overall Rating</div>
                            </div>
                            <div class="score-card">
                                <span class="score-number">${analysis.format_score}</span>
                                <div class="score-label">Format Score</div>
                            </div>
                            <div class="score-card">
                                <span class="score-number">${analysis.clarity_score}</span>
                                <div class="score-label">Clarity Score</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <strong>Tone Assessment:</strong>
                            <span class="tone-badge tone-${analysis.tone_assessment.toLowerCase().replace('-', '')}">${analysis.tone_assessment}</span>
                        </div>
                    </div>
                `;

                // Error handling
                if (analysis.error) {
                    html += `<div class="error-message">${analysis.error}</div>`;
                }

                // Strengths
                if (analysis.strengths && analysis.strengths.length > 0) {
                    html += `
                        <div class="result-card">
                            <div class="result-header">‚úÖ Strengths</div>
                            <ul class="list-items">
                                ${analysis.strengths.map(strength => `<li>${strength}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Improvements
                if (analysis.improvements && analysis.improvements.length > 0) {
                    html += `
                        <div class="result-card">
                            <div class="result-header">üí° Suggestions for Improvement</div>
                            <ul class="list-items improvements-list">
                                ${analysis.improvements.map(improvement => `<li>${improvement}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Grammar Issues
                if (analysis.grammar_issues && analysis.grammar_issues.length > 0) {
                    html += `
                        <div class="result-card">
                            <div class="result-header">üìù Grammar & Spelling Issues</div>
                            <ul class="list-items issues-list">
                                ${analysis.grammar_issues.map(issue => `<li>${issue}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Email Components Check
                html += this.generateComponentsCheck(data.components);

                this.resultsContent.innerHTML = html;
                this.resultsSection.classList.add('show');
            }

            generateComponentsCheck(components) {
                return `
                    <div class="result-card">
                        <div class="result-header">üîç Email Components Analysis</div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                            <div class="component-check">
                                <div class="check-icon ${components.has_subject ? 'check-yes' : 'check-no'}">
                                    ${components.has_subject ? '‚úì' : '‚úó'}
                                </div>
                                <span>Subject Line</span>
                            </div>
                            <div class="component-check">
                                <div class="check-icon ${components.has_greeting ? 'check-yes' : 'check-no'}">
                                    ${components.has_greeting ? '‚úì' : '‚úó'}
                                </div>
                                <span>Professional Greeting</span>
                            </div>
                            <div class="component-check">
                                <div class="check-icon ${components.has_closing ? 'check-yes' : 'check-no'}">
                                    ${components.has_closing ? '‚úì' : '‚úó'}
                                </div>
                                <span>Professional Closing</span>
                            </div>
                            <div class="component-check">
                                <div class="check-icon ${components.has_signature ? 'check-yes' : 'check-no'}">
                                    ${components.has_signature ? '‚úì' : '‚úó'}
                                </div>
                                <span>Signature</span>
                            </div>
                        </div>
                        <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">
                            <div>
                                <strong style="color: #4facfe; font-size: 1.5em;">${components.word_count}</strong>
                                <div style="color: #666; font-size: 0.9em;">Words</div>
                            </div>
                            <div>
                                <strong style="color: #4facfe; font-size: 1.5em;">${components.character_count}</strong>
                                <div style="color: #666; font-size: 0.9em;">Characters</div>
                            </div>
                            <div>
                                <strong style="color: #4facfe; font-size: 1.5em;">${components.paragraph_count}</strong>
                                <div style="color: #666; font-size: 0.9em;">Paragraphs</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            showError(message) {
                this.resultsContent.innerHTML = `<div class="error-message">${message}</div>`;
                this.resultsSection.classList.add('show');
            }

            setLoading(button, isLoading) {
                const btnText = button.querySelector('.btn-text');
                const loading = button.querySelector('.loading');
                
                button.disabled = isLoading;
                if (isLoading) {
                    btnText.style.display = 'none';
                    loading.style.display = 'flex';
                } else {
                    btnText.style.display = 'inline';
                    loading.style.display = 'none';
                }
            }
        }

        function switchMode(mode) {
            // Update active mode button
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show/hide mode sections
            document.querySelectorAll('.mode-section').forEach(section => section.classList.remove('active'));
            document.getElementById(mode + 'Mode').classList.add('active');
            
            // Hide results when switching modes
            document.getElementById('resultsSection').classList.remove('show');
            
            // Update current mode
            if (window.emailProcessor) {
                window.emailProcessor.currentMode = mode;
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.emailProcessor = new SmartEmailProcessor();
        });
    </script>
</body>
</html><span class="score-number">${analysis.overall_rating}</span>
                                <div class="score-label">Overall Rating</div>
                            </div>
                            <div class="score-card">